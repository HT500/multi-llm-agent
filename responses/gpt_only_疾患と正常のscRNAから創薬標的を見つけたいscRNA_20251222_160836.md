# GPTのみ系統の出力例

## 実行情報

- **実行日時**: 2025-12-22 16:08:36
- **質問**:  疾患と正常のscRNAから創薬標的を見つけたい。scRNAは疾患と正常の細胞分布が異なるため、どのように同一細胞をそろえて、DEGをとれば良いか？ 
- **統合方式**: weighted
- **信頼度**: 0.38
- **生成された回答数**: 3

## 使用モデルとreasoning.effortの組み合わせ

- GPT-5.2 + Thinking標準
- GPT-mini + Thinking標準
- GPT-pro Pro + Thinking高

## 各モデルの個別出力

### GPT-5.2 + Thinking標準

- **モデル**: `gpt-5.2`
- **reasoning.effort**: `medium`

疾患 vs 正常の scRNA-seq では「細胞種（あるいは細胞状態）の比率が違う」ため、全細胞をまとめて DEG を取ると **“細胞構成の違い” が DEG として出てしまう**（擬陽性）ことがよく起きます。したがって基本方針は、

1) **同一の細胞種/状態を揃える（ラベリング or マッピング）**  
2) **“細胞数の違い（Differential abundance）” と “発現の違い（Differential expression）” を分離して解析する**  
3) DEG は原則 **ドナー（患者）単位の反復**を活かして統計する（pseudobulk や混合モデル）

です。以下に実務的な手順を示します。

---

## 1. まず「何を揃えるか」を決める：細胞種か、細胞状態か
- 創薬標的探索では多くの場合、**細胞種（例：CD4 T, マクロファージ等）単位**＋必要に応じて **活性化状態/分化段階（状態）**まで分けます。  
- 疾患で新しい状態が出現することもあるため、正常に無い状態を無理に対応付けると誤ります。  
  - この場合は「共有状態では DEG」「疾患特異状態は別枠で特徴遺伝子（marker）・経路」を見る、が安全です。

---

## 2. 細胞を揃える方法（代表的な2ルート）

### ルートA：参照アトラス/既知ラベルを使って細胞注釈 → 同一ラベル内で比較
1) QC・ダブレット除去・基本正規化（または raw count を前提とするモデルを使用）  
2) **参照データ（健常アトラス等）にマッピングして細胞種注釈**  
   - 近年は「raw count 行列からの注釈」を含む ML/統計的手法が多数（レビュー的には *scRNA 注釈を raw count matrix から行う* 方向性が整理されています：提示文献1の趣旨）。  
   - 実務では Seurat label transfer / scArches / scVI 系 / SingleR などが選択肢です。
3) 同一細胞種（必要なら同一サブクラスター）に分けて DEG

**長所**：解釈が明確、創薬標的（細胞種特異的）に落とし込みやすい  
**注意**：参照が不適切だとラベルが崩れる／疾患特異状態が「既存ラベル」に吸収される

---

### ルートB：統合埋め込みで「対応する細胞」を近傍マッチングして比較（状態まで揃えたいとき）
1) バッチ/条件差を考慮した統合（Harmony, Seurat統合, scVI など）  
2) 統合空間で **相互最近傍（MNN）**や kNN を使い、疾患細胞に対応する正常細胞を近傍から選ぶ  
3) そのペア/近傍集合内で差分を評価（ただし統計はドナー反復を考慮）

**長所**：細胞状態の連続性を保ったまま“同じ状態同士”を比べやすい  
**注意**：統合が強すぎると本当の疾患差が消える／マッチングの恣意性が入る

---

## 3. 「細胞数の違い」と「発現の違い」を必ず分ける
疾患で細胞分布が違う場合、やるべき解析は通常2本立てです。

### (i) Differential abundance（DA）：細胞種比率が変わったか
- 例：マクロファージが増えた、ある T 細胞が減った  
- Milo, DA-seq 等、あるいはサンプル単位で細胞比率を一般化線形モデルで比較  
- これ自体が創薬標的のヒント（「増えた細胞種のドライバー経路」など）

### (ii) Differential expression（DE）：同一細胞種/状態内で発現が変わったか
- これが「創薬標的候補遺伝子」を直接出しやすい

---

## 4. DEG（DE）を取るときの推奨：pseudobulk（ドナー単位）か混合モデル
**最重要の落とし穴**：細胞を独立サンプルとして扱うと（擬似反復）、p値が過小評価されがちです。

### 推奨A：pseudobulk
- 各ドナー×細胞種ごとにカウントを合算して **“バルクRNA-seq” のように** DESeq2/edgeR/limma-voom で比較  
- 条件（疾患/正常）＋共変量（年齢・性別・バッチ・投薬等）をモデル化しやすい

### 推奨B：細胞レベル混合モデル
- ドナーをランダム効果に入れる（MAST の拡張など）
- ただし計算・収束・前提が難しいことも多い

---

## 5. 「同一細胞を揃える」実務テンプレ（おすすめの一連）
1) **サンプル設計確認**：最低限「複数ドナー/複数患者」が必要（条件ごとに n を確保）  
2) QC（ミトコンドリア比、UMI、遺伝子数、ダブレット）  
3) 注釈：参照マッピング（ルートA）＋必要なら統合空間でサブクラスタ（状態）  
4) **共有される細胞種/状態**を定義  
   - 疾患にしか無い状態は「疾患特異クラス」として別解析  
5) DA（比率変動）を解析  
6) DE：共有クラスごとに pseudobulk で DEG  
7) 創薬標的化：  
   - 上流因子（転写因子/シグナル）、細胞表面分子、分泌因子、リガンド–受容体、経路（GSEA）  
   - 「増えた細胞種」×「その細胞種で上がった経路/表面分子」を優先すると合理的

---

## 6. よくある失敗と回避策
- **全細胞で DEG** → 細胞構成差が混入：必ず細胞種/状態で層別化  
- **統合で差が消える**：統合は「注釈や対応付け」用、DE は生データ（元カウント）に戻って pseudobulk 等で行う  
- **正常に無い疾患状態を無理に対応付ける**：疾患特異クラスとして扱い、marker/経路/相互作用解析へ  
- **ドナー反復なし**：創薬標的の統計的確度が落ちる（探索的解析に留める）

---

必要なら、あなたのデータ条件（疾患名、組織、ドナー数、10x などのプラットフォーム、既存の参照アトラスの有無、疾患特異クラスの有無）を教えてください。  
それに合わせて「注釈ルート（A/B）」「DA/DE の具体的ツール選定」「pseudobulk のモデル式（共変量）」まで落とし込んだ手順を提案できます。

### GPT-mini + Thinking標準

- **モデル**: `gpt-5-mini`
- **reasoning.effort**: `medium`

いい質問です。要点は「同じ細胞型（あるいは同じ細胞状態）を正しく対応づけた上で、その内部で発現差（DEG）を評価する」ことと、「疾患と正常で細胞組成が変わる（差分数・新規状態が生じる）点を解析設計で分離する」ことです。以下に実務的なワークフロー、推奨手法、注意点、簡単なコード例（R中心）をまとめます。

1) 全体方針（概念）
- 目的を明確にする：
  - 「細胞型の構成比の変化（差分アバンダンス）」を調べたいのか、
  - 「同一細胞型内での遺伝子発現変化（真のDEG）」を調べたいのか。
  両方を分けて解析するのがベスト（別々の手法が必要）。
- 流れ（大まか）：
  1. QC・正規化
  2. データ統合／アライン（同一細胞型を対応づける）
  3. 細胞型注釈（ラベル移植などで同じラベルを付ける）
  4. 細胞型ごとにDE解析（できればサンプルごとのpseudobulk）
  5. 細胞数変動（DA; differential abundance）の解析
  6. バリデーション（独立コホート・実験）

2) データ統合（同一セルをそろえる）— 推奨手法と注意
- 代表的手法：
  - Seurat（FindIntegrationAnchors / IntegrateData）→ ラベル移植（FindTransferAnchors / TransferData）
  - Harmony（バッチを取り除きつつクラスタ構造を保つ）
  - MNN / fastMNN（batchelorパッケージ）
  - Scanorama, LIGER
  - scVI / scANVI（深層確率モデル、バッチと状態のモデル化が柔軟）
- 注意点：
  - 「過度に補正すると疾患由来の生物学的差が消える」：条件（疾患/正常）に関連するシグナルを補正しないよう設定すること。たとえば、条件ラベルをバッチとして扱って補正しない。
  - まずは個別データでクラスタ・マーカーを確認し、どの細胞型が共通か確認する（overcorrectionを避けるため）。
- 実務的ワークフロー：
  - まず各サンプルでQC・正規化（例：SCTransformやlog-normalization）を行う
  - バッチ統合は「細胞型を対応づけるためだけ」に行い、DE解析は統合データではなく元のカウントに戻して行う（後述のpseudobulk）

3) 細胞注釈（同一細胞型のラベル付け）
- 方法：
  - Marker遺伝子ベースで手動注釈
  - 既知アノテーションデータを使ったラベル転送（SeuratのTransferData、scANVI）
  - 教師あり分類器（SingleR, scPred, cellassignなど）
- ポイント：注釈はサンプルごとに一貫していること（各サンプル／各条件で同じラベル定義）を確認する。

4) DEG解析 — 推奨アプローチ（最も重要）
- なぜ注意が必要か：
  - scRNA単位で直接DE検定をすると「サンプルの擬似複製（pseudoreplication）」で偽陽性が増える。
- 推奨：pseudobulk（サンプルごと、かつ細胞型ごとにカウントを集約して遺伝子ごとにサンプル数の統計を行う）
  - 手順：
    1. 同じ細胞型の細胞をサンプルごとに合算（raw counts を合計）して1つの擬似バルクサンプルを作る。
    2. 得られたサンプル数（生物学的レプリケート）を用いてedgeR / DESeq2 / limma-voom等でDE解析。デザインに condition + covariates（年齢・性別・バッチなど）を入れる。
  - 理由：生物学的レプリケート単位で推測でき、標準的な差次解析法が使える。
- 代替（サンプル数が少ない等）：
  - 混合効果モデル（例：MAST with random effect）を使用して個体ごとのランダム効果を入れる方法。ただし計算コストが高く、偽陽性制御が難しい場合がある。
  - scVI/scANVIの差次解析ツール（latent space を用いたDE）も有効だが結果の解釈・検証が必要。
- 重要な共変量：
  - 個体（donor）をrandom effectまたは解析単位にする
  - 年齢・性別・収集条件・細胞品質メトリクス（nUMI, %mito）などを調整
- 多重検定と発現閾値：
  - FDR（Benjamini–Hochberg）で補正、fold-changeの閾値も併用（例：log2FC > 0.25〜0.5を目安。ただし状況次第）

5) 細胞数変動（差分アバンダンス）の解析
- 細胞型比の変化は別解析にすべき（DEの混乱を避ける）：
  - 細胞数をサンプルごとに集計してedgeR/DESeq2で解析（設計： condition + covariates）
  - あるいは Milo, DAseq 等の局所領域ベースの差分アバンダンス検出ツールを使う（クラスタを超えた微妙な領域変化を捉えられる）
- これにより 「ある細胞型が増えているのか、同一細胞型の内部で状態が変わっているのか」を分離して議論できる。

6) 実践的なRのコード例（概念的）
- Seuratによる統合とラベル転送（極短縮版）

raw:
library(Seurat)
# 1. 各サンプルでQC/正規化（例: SCTransform）
samples <- list(s1, s2, ...) # 各Seuratオブジェクト
samples <- lapply(samples, SCTransform)

# 2. アンカー統合（同一細胞型対応づけ）
anchors <- FindIntegrationAnchors(object.list = samples, normalization.method = "SCT")
int <- IntegrateData(anchors, normalization.method = "SCT")

# 3. ラベル転送（既知参照がある場合）
# ref: 参照データ（注釈済みSeuratオブジェクト）
transfer.anchors <- FindTransferAnchors(reference = ref, query = int, normalization.method = "SCT")
pred <- TransferData(anchorset = transfer.anchors, refdata = ref$celltype)
int$predicted.celltype <- pred$predicted.id

- pseudobulk 集計と edgeR の概念（極簡略）
# pseudo-bulk: 各サンプル・各celltypeでcountsを合算
# 例: for each gene create matrix [genes x samples]
library(edgeR)
# counts_mat: genes x samples for a given celltype
group <- factor(c("control","disease",...))
y <- DGEList(counts=counts_mat, group=group)
y <- calcNormFactors(y)
design <- model.matrix(~ group + covariates)
y <- estimateDisp(y, design)
fit <- glmQLFit(y, design)
res <- glmQLFTest(fit, coef="groupdisease")
topTags(res)

7) scVI/scANVI を使う場合の利点
- 深層確率モデルでバッチと条件を同時に扱える（scVIはDE検定ツールを持つ）
- scANVIは既知ラベルを使ったラベル転送が得意
- ただしモデル仮定を理解し、結果はpseudobulkでの再確認を推奨

8) 追加のテクニック・注意点
- 細胞サブセットの細かい状態（例：activated vs resting）は別々に扱うこと。クラスタを細かく取りすぎてサンプル単位のカウントが不足しないよう注意。
- 発現差が少ない場合やサンプル数が少ない場合、偽陰性や不安定な結果になりやすい。可能ならサンプル数（ドナー数）を増やす。
- 可視化：UMAP/tSNEは参考になるが統合処理の影響を受けるので、必ずマーカー発現で注釈を検証。
- 過度のバッチ除去は疾患シグナルを消す：条件ラベルをバッチと同化させない、もしくは条件別に分けて解析するなど配慮。

9) 検証とフォローアップ
- 独立コホート、またはbulk RNA（pseudobulk結果）やフローサイトメトリー、イムノスタイニングで候補遺伝子を検証する。
- 機能実験（ノックダウン/阻害）で薬剤標的としての妥当性を評価。

10) 要点まとめ（チェックリスト）
- QC・正規化を丁寧に行う
- 統合は「対応づけ（label transfer）」のために使い、DEは元の/擬似バルクカウントで行う
- DEGは可能ならpseudobulk + edgeR/DESeq2/limmaで行う（個体を解析単位に）
- 細胞組成の変化は別途解析（Milo, DAseq, 集計→edgeR等）
- 過剰補正に注意、scVI等のモデルも結果を再検証する
- 候補は独立データ・実験で検証する

必要なら、あなたのデータの特性（サンプル数、ドナー当たりの細胞数、期待される細胞型、使用ツール(Seurat/Scanpy/scVIなど)）を教えてください。具体的なコマンドやスクリプト、パラメータを使ったより詳細なワークフロー（例：Seurat + edgeRによる完全なパイプライン）を提示します。

### GPT-pro Pro + Thinking高

- **モデル**: `gpt-5.2-pro`
- **reasoning.effort**: `high`

疾患と正常で **細胞組成（cell type / state の比率）が違う** scRNA-seq から創薬標的候補（DEG）を得るときは、基本的に解析を **(1) 細胞数の変化（Differential abundance）** と **(2) 同一細胞種/状態内での発現変化（Differential expression）** に分け、(2) のために「同一細胞をそろえる（=同じ cell type / cell state に“対応付ける”）」手順を入れるのが安全です。  
以下に、実務で破綻しにくいワークフローを示します。

---

## 1) 「同一細胞をそろえる」の正体：cell type / cell state を揃える
“同一細胞”を1対1で揃えるというより、**同じ生物学的カテゴリ（cell type / state）にラベル付けして、その中で比較**します。

### A. まず cell type を揃える（注釈付け）
- **正常側を参照（リファレンス）**にして、疾患側を **mapping / label transfer** するのが堅いです。  
- ご提示の文脈（論文1）でも、**raw count matrix を入力にした ML/統計/AI による注釈**が整理されており、参照付き注釈（既知ラベルで学習→予測）が現場では最も再現性が出やすいです。

代表的アプローチ（どれでも可）：
- **参照マッピング/ラベル転送**：Seurat（FindTransferAnchors/MapQuery）、Azimuth、scArches、scmap 等  
- **潜在空間モデル**：scVI/scANVI（バッチ差やドナー差を吸収しつつ注釈）
- **古典ML**（論文1の方向性）：raw count 由来特徴量でRF/SVM/NN等で cell type 分類（ただし前処理とクラス不均衡に注意）

> ポイント：疾患効果まで消してしまう強い統合（integration）を“DEGのため”に使いすぎないこと。  
> **統合は「対応付け（揃える）」のため**、DEG自体は後述のように **元のカウント（or 最小限補正）** で行うのが基本です。

---

## 2) cell state まで揃える（必要な場合）
同じT細胞でも、疾患で活性化・疲弊など **状態（state）が変わる**ため、cell type だけだと混ざってDEGが濁ります。

やり方：
1. **cell typeごとにサブセット**（例：CD4 Tだけ取り出す）
2. その中で **再クラスタリング**（stateクラスタ）
3. 正常・疾患のクラスタ対応を取る  
   - mutual nearest neighbors（MNN）  
   - 統合空間での最近傍対応  
   - 参照側stateへmapping（scArches等が強い）

この段階で、
- **正常に存在しない疾患特異的state** が出ることがあります  
  → 無理に“同一”として揃えず、「新規state」として **マーカー遺伝子/経路（program）抽出**を行い、近い正常stateと“距離”で比較（類似度/遺伝子プログラム）する方が創薬標的探索として有益です。

---

## 3) DEGは「細胞」ではなく「サンプル（ドナー/個体）」単位で比較（擬似バルク推奨）
細胞数が多いと、**細胞を独立標本扱い**する解析は偽陽性が増えやすいです。  
特に疾患と正常で細胞比率が違う状況では、**pseudobulk（擬似バルク）**が最も堅牢です。

### 擬似バルクDEGの定石
- 各サンプル（患者/健常者）×各cell type（またはstate）について、raw countを **合計**（もしくは平均ではなく合計が一般的）
- その行列に対して **edgeR / DESeq2 / limma-voom** で
  - デザイン：`~ condition + covariates（年齢/性別/バッチ等）`
  - 可能なら **ペアデザイン（同一患者の前後など）**：`~ patient + condition`

これにより
- 「疾患はそのcell typeが多いから見えているだけ」の混入を減らし
- 「同じcell type内の発現差」を明確に取れます

### どうしても単一細胞モデルでやるなら
- MAST などで **donorをランダム効果**に入れる、あるいは
- サンプルごとにバランスよくセルをサブサンプルして検証  
が必要です（それでも擬似バルクより不安定になりがちです）。

---

## 4) “細胞分布が違う”問題は、DEG以外に「差の本体」もある（Differential abundance）
疾患で
- あるcell typeが増える/減る
- あるstateが出現する  
こと自体が重要な病態シグナルです。DEGだけにすると取りこぼします。

併走推奨：
- **Differential abundance（DA）解析**：Milo、DA-seq、scCODA など  
→ 「どの細胞集団が増減しているか」を定量

そして
- DAで増えている集団の中でDEG/経路
- その遺伝子が薬で触れる標的か（膜タンパク、酵素、サイトカイン等）
という流れが創薬標的探索として自然です。

---

## 5) 実務フロー（最小構成）
1. QC/二重t検出/基本正規化（可視化用）
2. 正常を参照に **疾患細胞へラベル転送**（cell type）
3. 必要なら cell type内でサブクラスタ（state）し、対応付け
4. **cell type（or state）ごとにpseudobulk** を作る（サンプル単位）
5. DESeq2/edgeRで **疾患 vs 正常**（共変量も入れる）
6. 同時にDA解析で「増減する集団」も取る
7. DEGは経路解析＋標的適性（drugability、細胞外/膜局在、既知阻害剤等）で優先順位付け

---

## 6) 注意点（重要）
- **統合（integration）後の発現値でDEGしない**：統合は差を消すことがあるため、DEは原則raw count（pseudobulk）で。
- **患者数（サンプル数）が統計パワーの本体**：細胞数よりドナー数が効きます。
- **疾患特異的state**を“無理に正常へ割り当てる”と誤解釈：新規stateとして扱い、近縁集団との比較・プログラム抽出に回す。

---

もし、データの状況（例：ドナー数、臓器、10xかSmart-seqか、ペアサンプルの有無、既に注釈があるか）を教えていただければ、Seurat/Scanpy/scVIのどれで組むのが良いか、擬似バルクの作り方（集計単位やフィルタ）とデザイン式まで具体化して提案できます。

## 統合後の出力

疾患 vs 正常の scRNA-seq では「細胞種（あるいは細胞状態）の比率が違う」ため、全細胞をまとめて DEG を取ると **“細胞構成の違い” が DEG として出てしまう**（擬陽性）ことがよく起きます。したがって基本方針は、

1) **同一の細胞種/状態を揃える（ラベリング or マッピング）**  
2) **“細胞数の違い（Differential abundance）” と “発現の違い（Differential expression）” を分離して解析する**  
3) DEG は原則 **ドナー（患者）単位の反復**を活かして統計する（pseudobulk や混合モデル）

です。以下に実務的な手順を示します。

---

## 1. まず「何を揃えるか」を決める：細胞種か、細胞状態か
- 創薬標的探索では多くの場合、**細胞種（例：CD4 T, マクロファージ等）単位**＋必要に応じて **活性化状態/分化段階（状態）**まで分けます。  
- 疾患で新しい状態が出現することもあるため、正常に無い状態を無理に対応付けると誤ります。  
  - この場合は「共有状態では DEG」「疾患特異状態は別枠で特徴遺伝子（marker）・経路」を見る、が安全です。

---

## 2. 細胞を揃える方法（代表的な2ルート）

### ルートA：参照アトラス/既知ラベルを使って細胞注釈 → 同一ラベル内で比較
1) QC・ダブレット除去・基本正規化（または raw count を前提とするモデルを使用）  
2) **参照データ（健常アトラス等）にマッピングして細胞種注釈**  
   - 近年は「raw count 行列からの注釈」を含む ML/統計的手法が多数（レビュー的には *scRNA 注釈を raw count matrix から行う* 方向性が整理されています：提示文献1の趣旨）。  
   - 実務では Seurat label transfer / scArches / scVI 系 / SingleR などが選択肢です。
3) 同一細胞種（必要なら同一サブクラスター）に分けて DEG

**長所**：解釈が明確、創薬標的（細胞種特異的）に落とし込みやすい  
**注意**：参照が不適切だとラベルが崩れる／疾患特異状態が「既存ラベル」に吸収される

---

### ルートB：統合埋め込みで「対応する細胞」を近傍マッチングして比較（状態まで揃えたいとき）
1) バッチ/条件差を考慮した統合（Harmony, Seurat統合, scVI など）  
2) 統合空間で **相互最近傍（MNN）**や kNN を使い、疾患細胞に対応する正常細胞を近傍から選ぶ  
3) そのペア/近傍集合内で差分を評価（ただし統計はドナー反復を考慮）

**長所**：細胞状態の連続性を保ったまま“同じ状態同士”を比べやすい  
**注意**：統合が強すぎると本当の疾患差が消える／マッチングの恣意性が入る

---

## 3. 「細胞数の違い」と「発現の違い」を必ず分ける
疾患で細胞分布が違う場合、やるべき解析は通常2本立てです。

### (i) Differential abundance（DA）：細胞種比率が変わったか
- 例：マクロファージが増えた、ある T 細胞が減った  
- Milo, DA-seq 等、あるいはサンプル単位で細胞比率を一般化線形モデルで比較  
- これ自体が創薬標的のヒント（「増えた細胞種のドライバー経路」など）

### (ii) Differential expression（DE）：同一細胞種/状態内で発現が変わったか
- これが「創薬標的候補遺伝子」を直接出しやすい

---

## 4. DEG（DE）を取るときの推奨：pseudobulk（ドナー単位）か混合モデル
**最重要の落とし穴**：細胞を独立サンプルとして扱うと（擬似反復）、p値が過小評価されがちです。

### 推奨A：pseudobulk
- 各ドナー×細胞種ごとにカウントを合算して **“バルクRNA-seq” のように** DESeq2/edgeR/limma-voom で比較  
- 条件（疾患/正常）＋共変量（年齢・性別・バッチ・投薬等）をモデル化しやすい

### 推奨B：細胞レベル混合モデル
- ドナーをランダム効果に入れる（MAST の拡張など）
- ただし計算・収束・前提が難しいことも多い

---

## 5. 「同一細胞を揃える」実務テンプレ（おすすめの一連）
1) **サンプル設計確認**：最低限「複数ドナー/複数患者」が必要（条件ごとに n を確保）  
2) QC（ミトコンドリア比、UMI、遺伝子数、ダブレット）  
3) 注釈：参照マッピング（ルートA）＋必要なら統合空間でサブクラスタ（状態）  
4) **共有される細胞種/状態**を定義  
   - 疾患にしか無い状態は「疾患特異クラス」として別解析  
5) DA（比率変動）を解析  
6) DE：共有クラスごとに pseudobulk で DEG  
7) 創薬標的化：  
   - 上流因子（転写因子/シグナル）、細胞表面分子、分泌因子、リガンド–受容体、経路（GSEA）  
   - 「増えた細胞種」×「その細胞種で上がった経路/表面分子」を優先すると合理的

---

## 6. よくある失敗と回避策
- **全細胞で DEG** → 細胞構成差が混入：必ず細胞種/状態で層別化  
- **統合で差が消える**：統合は「注釈や対応付け」用、DE は生データ（元カウント）に戻って pseudobulk 等で行う  
- **正常に無い疾患状態を無理に対応付ける**：疾患特異クラスとして扱い、marker/経路/相互作用解析へ  
- **ドナー反復なし**：創薬標的の統計的確度が落ちる（探索的解析に留める）

---

必要なら、あなたのデータ条件（疾患名、組織、ドナー数、10x などのプラットフォーム、既存の参照アトラスの有無、疾患特異クラスの有無）を教えてください。  
それに合わせて「注釈ルート（A/B）」「DA/DE の具体的ツール選定」「pseudobulk のモデル式（共変量）」まで落とし込んだ手順を提案できます。

## 調査結果サマリー

- **論文数**: 50
- **データベース結果数**: 0
- **アプリケーション結果数**: 0

